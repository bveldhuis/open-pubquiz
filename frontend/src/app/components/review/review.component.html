@if (question) {
  <div class="review-container">
    <!-- Question Header -->
    <div class="review-header">
      <div class="question-info">
        <h2>Question {{ question.question_number }} Review</h2>
        <div class="question-meta">
          <span class="question-type-badge">{{ getQuestionTypeLabel(question.type) }}</span>
          <span class="points">{{ question.points }} points</span>
        </div>
      </div>
      <div class="review-stats">
        <div class="stat">
          <span class="stat-value">{{ answers.length }}</span>
          <span class="stat-label">Teams</span>
        </div>
        <div class="stat">
          <span class="stat-value">{{ getCorrectCount() }}</span>
          <span class="stat-label">Correct</span>
        </div>
        <div class="stat">
          <span class="stat-value">{{ getAccuracyPercentage() }}%</span>
          <span class="stat-label">Accuracy</span>
        </div>
      </div>
    </div>
    <!-- Question Display -->
    <div class="question-display">
      <h3>{{ question.question_text }}</h3>
      @if (question.fun_fact) {
        <div class="fun-fact">
          <mat-icon>lightbulb</mat-icon>
          <p>{{ question.fun_fact }}</p>
        </div>
      }
      <!-- Correct Answer Display -->
      @if (showCorrectAnswer) {
        <div class="correct-answer">
          <h4>Correct Answer:</h4>
          <div class="answer-content">
            @switch (question.type) {
              <!-- Multiple Choice -->
              @case ('multiple_choice') {
                <div class="multiple-choice-answer">
                  <div class="option correct">
                    <span class="option-letter">{{ getCorrectOptionLetter() }}</span>
                    <span class="option-text">{{ question.correct_answer }}</span>
                    <mat-icon>check_circle</mat-icon>
                  </div>
                </div>
              }
              <!-- Open Text -->
              @case ('open_text') {
                <div class="text-answer">
                  <p>{{ question.correct_answer }}</p>
                </div>
              }
              <!-- Numerical -->
              @case ('numerical') {
                <div class="numerical-answer">
                  <p>{{ question.numerical_answer }}{{ question.numerical_tolerance ? ' (Â±' + question.numerical_tolerance + ')' : '' }}</p>
                </div>
              }
              <!-- Sequence -->
              @case ('sequence') {
                <div class="sequence-answer">
                  <div class="sequence-items">
                    @for (item of question.sequence_items; track item; let i = $index) {
                      <div class="sequence-item">
                        <span class="sequence-number">{{ i + 1 }}</span>
                        <span class="sequence-text">{{ item }}</span>
                      </div>
                    }
                  </div>
                </div>
              }
            }
          </div>
        </div>
      }
    </div>
    <!-- Action Buttons -->
    <div class="button-group">
      <button mat-raised-button (click)="toggleCorrectAnswer()">
        <mat-icon>{{ showCorrectAnswer ? 'visibility_off' : 'visibility' }}</mat-icon>
        {{ showCorrectAnswer ? 'Hide' : 'Show' }} Correct Answer
      </button>
      <button mat-raised-button color="primary" (click)="showLeaderboard.emit()">
        <mat-icon>leaderboard</mat-icon>
        Show Leaderboard
      </button>
      @if (hasNextQuestion) {
        <button mat-raised-button color="accent" (click)="nextQuestion.emit()">
          <mat-icon>skip_next</mat-icon>
          Next Question
        </button>
      }
    </div>
  </div>
}
